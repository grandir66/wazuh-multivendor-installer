<!-- Stormshield Firewall Decoders for Wazuh -->
<!-- https://github.com/grandir66/wazuh-multivendor-installer -->
<!-- Rule IDs: 100400-100499 -->

<!-- Main Stormshield decoder -->
<decoder name="stormshield">
  <prematch>^time="</prematch>
</decoder>

<!-- Single decoder to extract all alarm fields -->
<decoder name="stormshield-alarm">
  <parent>stormshield</parent>
  <prematch>logtype="alarm"</prematch>
  <regex>^time="(\d+-\d+-\d+ \d+:\d+:\d+)" fw="(\w+)"</regex>
  <order>time,fw</order>
</decoder>

<!-- Fallback -->
<decoder name="stormshield-generic">
  <parent>stormshield</parent>
  <regex>^time="(\d+-\d+-\d+ \d+:\d+:\d+)" fw="(\w+)"</regex>
  <order>time,fw</order>
</decoder>
