<!-- Stormshield Firewall Decoders for Wazuh -->
<!-- https://github.com/grandir66/wazuh-multivendor-installer -->
<!-- Rule IDs: 100400-100499 -->

<!-- Main Stormshield decoder -->
<decoder name="stormshield">
  <prematch>id=firewall</prematch>
</decoder>

<!-- Extract fields using simple patterns -->
<decoder name="stormshield-time-fw">
  <parent>stormshield</parent>
  <regex>time="(\.+)" fw="(\.+)"</regex>
  <order>time, fw</order>
</decoder>

<decoder name="stormshield-pri">
  <parent>stormshield</parent>
  <regex>pri=(\d)</regex>
  <order>pri</order>
</decoder>

<decoder name="stormshield-srcip">
  <parent>stormshield</parent>
  <regex>src=(\d+\.\d+\.\d+\.\d+)</regex>
  <order>srcip</order>
</decoder>

<decoder name="stormshield-srcport">
  <parent>stormshield</parent>
  <regex>srcport=(\d+)</regex>
  <order>srcport</order>
</decoder>

<decoder name="stormshield-dstip">
  <parent>stormshield</parent>
  <regex>dst=(\d+\.\d+\.\d+\.\d+)</regex>
  <order>dstip</order>
</decoder>

<decoder name="stormshield-dstport">
  <parent>stormshield</parent>
  <regex>dstport=(\d+)</regex>
  <order>dstport</order>
</decoder>

<decoder name="stormshield-action">
  <parent>stormshield</parent>
  <regex>action=(\w+)</regex>
  <order>stormshield_action</order>
</decoder>

<decoder name="stormshield-msg">
  <parent>stormshield</parent>
  <regex>msg="(\.+)"</regex>
  <order>msg</order>
</decoder>

<decoder name="stormshield-logtype">
  <parent>stormshield</parent>
  <regex>logtype="(\w+)"</regex>
  <order>logtype</order>
</decoder>

<decoder name="stormshield-alarmid">
  <parent>stormshield</parent>
  <regex>alarmid=(\d+)</regex>
  <order>alarmid</order>
</decoder>

<decoder name="stormshield-user">
  <parent>stormshield</parent>
  <regex>user="(\.+)"</regex>
  <order>user</order>
</decoder>

<decoder name="stormshield-address">
  <parent>stormshield</parent>
  <regex>address=(\S+)</regex>
  <order>address</order>
</decoder>

<decoder name="stormshield-error">
  <parent>stormshield</parent>
  <regex>error=(\d+)</regex>
  <order>error</order>
</decoder>

<decoder name="stormshield-ipproto">
  <parent>stormshield</parent>
  <regex>ipproto=(\w+)</regex>
  <order>ipproto</order>
</decoder>

<decoder name="stormshield-srcifname">
  <parent>stormshield</parent>
  <regex>srcifname="(\.+)"</regex>
  <order>srcifname</order>
</decoder>

<decoder name="stormshield-dstifname">
  <parent>stormshield</parent>
  <regex>dstifname="(\.+)"</regex>
  <order>dstifname</order>
</decoder>

<decoder name="stormshield-ruleid">
  <parent>stormshield</parent>
  <regex>ruleid=(\d+)</regex>
  <order>ruleid</order>
</decoder>

<decoder name="stormshield-class">
  <parent>stormshield</parent>
  <regex>class=(\w+)</regex>
  <order>class</order>
</decoder>
